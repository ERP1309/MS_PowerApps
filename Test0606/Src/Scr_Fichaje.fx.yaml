Scr_Fichaje As screen:

    "Map1 As 'Mapa (versión preliminar)'.pcfdataset":
        BorderColor: =RGBA(0, 18, 107, 1)
        Compass: =false
        CurrentLocation: =false
        CurrentLocationLatitude: =Latitude_1
        CurrentLocationLongitude: =Longitude_1
        DefaultLatitude: =Latitude_1
        DefaultLocation: =true
        DefaultLongitude: =Longitude_1
        DefaultZoomLevel: =15
        DisplayMode: =DisplayMode.Edit
        Height: =635
        InfoCards: ='Map.InfoCards'.None
        Items: =Location
        ItemsLatitudes: ="Latitude"
        ItemsLongitudes: ="Longitude"
        PinColor: =RGBA(255, 0, 0, 1)
        Pitch: =false
        Visible: =true
        Width: =640
        X: =0
        Y: =500
        ZIndex: =8
        Zoom: =false

    Label5 As label:
        Height: =83
        Size: =21
        Text: =Text(Fecha_1,"dd/mm/yyyy")
        Width: =240
        X: =200
        Y: =275
        ZIndex: =9

    Label5_1 As label:
        Height: =108
        Size: =21
        Text: |-
            =Text(hora_1,"h:mm")
        Width: =240
        X: =200
        Y: =325
        ZIndex: =10

    Label10 As label:
        Height: =63
        Size: =21
        Text: |-
            ="Fecha:"
        Width: =200
        X: =40
        Y: =281
        ZIndex: =11

    Label10_1 As label:
        Height: =60
        Size: =21
        Text: |-
            ="Hora:"
        Width: =176
        X: =40
        Y: =344
        ZIndex: =12

    Button4 As button:
        Height: =70
        OnSelect: |-
            =Set(
                Latitude_1,
                Text(Location.Latitude)
            ) And Set(
                Longitude_1,
                Text(Location.Longitude)
            ) And Set(
                Fecha_1,
                Today()
            ) And Set(
                hora_1,
                TimeValue(
                    Text(
                        Now(),
                        "h:mm"
                    ),
                    "es-MX"
                )
            ) And Set(
                Tiempo_Tardanza,
                If(
                    DateDiff(
                        DateAdd(
                            Text(
                                LookUp(
                                    Tabla2,
                                    Empresas = Dd_empresa.Selected.Empresas,
                                    'Horario Entrada'
                                ),
                                "h:mm"
                            ),
                            Text(
                                LookUp(
                                    Tabla2,
                                    Empresas = Dd_empresa.Selected.Empresas,
                                    'Tiempo de Tolerancia (Min.)'
                                ),
                                "h:mm"
                            ),
                            TimeUnit.Minutes
                        ),
                        Text(
                            hora_1,
                            "h:mm"
                        ),
                        TimeUnit.Minutes
                    ) > 0,
                    DateDiff(
                        Text(
                            LookUp(
                                Tabla2,
                                Empresas = Dd_empresa.Selected.Empresas,
                                'Horario Entrada'
                            ),
                            "h:mm"
                        ),
                        Text(
                            hora_1,
                            "h:mm"
                        ),
                        TimeUnit.Minutes
                    ),
                    0
                )
            );
            Patch(
                Tabla1,
                Defaults(Tabla1),
                {Guid:Text(GUID())},
                {'Usuario Marcación': UserBD.'Id. Usuario'},
                {'Nombre Completo': UsuariosdeOffice365.MyProfile().DisplayName},
                {'E-Mail': UsuariosdeOffice365.MyProfile().Mail},
                {'Empresa Asiganada': Dd_empresa.Selected.Empresas},
                {Latitude: Latitude_1},
                {Longitude: Longitude_1},
                {'Tipo De Marcación': "Entrada"},
                {'Hora Marcación': hora_1},
                {Tardanza: Tiempo_Tardanza}
            );Reset(Dd_empresa)And Reset(UserLog_2) 
        Size: =24
        Text: ="Hora Ingreso"
        Width: =280
        X: =40
        Y: =404
        ZIndex: =13

    Button4_1 As button:
        Height: =70
        OnSelect: |-
            =Set(
                Latitude_1,
                Text(Location.Latitude)
            ) And Set(
                Longitude_1,
                Text(Location.Longitude)
            ) And Set(
                Fecha_1,
                Today()
            ) And Set(
                hora_1,
                TimeValue(
                    Text(
                        Now(),
                        "h:mm am/pm"
                    ),
                    "es-MX"
                )
            ) And Set(
                Min_Adicionales,
                If(
                    DateDiff(
                        Text(
                            hora_1,
                            "h:mm am/pm"
                        ),
                        Text(
                            LookUp(
                                Tabla2,
                                Empresas = Text(Dd_empresa.Selected.Empresas),
                                'Horario Salida'
                            ),
                            "h:mm am/pm"
                        ),
                        TimeUnit.Minutes
                    ) < 0,
                    DateDiff(
                        Text(
                            LookUp(
                                Tabla2,
                                Empresas = Text(Dd_empresa.Selected.Empresas),
                                'Horario Salida'
                            ),
                            "h:mm am/pm"
                        ),
                        Text(
                            hora_1,
                            "h:mm am/pm"
                        ),
                        TimeUnit.Minutes
                    ),
                    0
                )
            );
            Patch(
                Tabla1,
                Defaults(Tabla1),
                {Guid: Text(GUID())},
                {'Usuario Marcación': UserBD.'Id. Usuario'},
                {'Nombre Completo': UsuariosdeOffice365.MyProfile().DisplayName},
                {'E-Mail': UsuariosdeOffice365.MyProfile().Mail},
                {'Empresa Asiganada':Dd_empresa.Selected.Empresas},
                {Latitude: Latitude_1},
                {Longitude: Longitude_1},
                {'Tipo De Marcación': "Salida"},
                {'Hora Marcación': hora_1},
                {'Minutos Adicionales':Min_Adicionales}
            )
        Size: =24
        Text: ="Hora Salida"
        Width: =280
        X: =336
        Y: =404
        ZIndex: =14

    Dd_empresa As dropdown:
        Height: =70
        Items: =Tabla2
        Size: =21
        Width: =299
        X: =306
        Y: =120
        ZIndex: =16

    Label2 As label:
        Height: =70
        Size: =21
        Text: |-
            ="Empresa Asignada: "
        Width: =266
        X: =40
        Y: =120
        ZIndex: =17

